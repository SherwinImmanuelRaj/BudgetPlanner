<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Budget Planning App</title>
        <link rel="stylesheet" href="style.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <!-- Google APIs -->
        <script src="https://apis.google.com/js/api.js"></script>
        <script src="https://accounts.google.com/gsi/client"></script>
    </head>
    <body>
        <!-- Login Screen -->
        <div id="loginScreen" class="login-screen">
            <div class="login-container">
                <div class="login-card">
                    <h1 class="login-title">Budget Planning App</h1>
                    <p class="login-subtitle">
                        Secure your financial data with Google authentication
                    </p>
                    <div
                        id="g_id_onload"
                        data-client_id="264294259025-p9mp7hpo23l4ni8teppstb2tc5rkjqg1.apps.googleusercontent.com"
                        data-context="signin"
                        data-ux_mode="popup"
                        data-callback="handleCredentialResponse"
                        data-auto_prompt="false"
                    ></div>
                    <div
                        class="g_id_signin"
                        data-type="standard"
                        data-shape="rectangular"
                        data-theme="filled_blue"
                        data-text="signin_with"
                        data-size="large"
                        data-logo_alignment="left"
                    ></div>
                    <div class="login-features">
                        <div class="feature">
                            <span class="feature-icon">üîí</span>
                            <span>Secure Google Authentication</span>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">‚òÅÔ∏è</span>
                            <span>Cloud Storage via Google Sheets</span>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">üåê</span>
                            <span>Works Across All Browsers</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main App (hidden until authenticated) -->
        <div id="mainApp" class="main-app" style="display: none">
            <!-- User Info Bar -->
            <div class="user-info-bar">
                <div class="user-profile">
                    <img
                        id="userPhoto"
                        class="user-avatar"
                        src=""
                        alt="User Photo"
                    />
                    <span id="userName" class="user-name"></span>
                </div>
                <button id="logoutBtn" class="logout-btn">Logout</button>
            </div>

            <!-- App Header -->
            <header class="app-header">
                <div class="header-content">
                    <h1 class="app-title">Budget Planning</h1>
                    <div class="header-controls">
                        <div class="month-navigator">
                            <button
                                class="nav-button"
                                onclick="budgetApp.previousMonth()"
                                title="Previous Month"
                            >
                                <svg viewBox="0 0 24 24" class="nav-icon">
                                    <polyline
                                        points="15,18 9,12 15,6"
                                    ></polyline>
                                </svg>
                            </button>
                            <span id="currentMonth" class="current-month"
                                >January 2024</span
                            >
                            <button
                                class="nav-button"
                                onclick="budgetApp.nextMonth()"
                                title="Next Month"
                            >
                                <svg viewBox="0 0 24 24" class="nav-icon">
                                    <polyline
                                        points="9,18 15,12 9,6"
                                    ></polyline>
                                </svg>
                            </button>
                        </div>
                        <button
                            class="primary-button"
                            onclick="budgetApp.showAdminPanel()"
                            title="Admin Panel"
                        >
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path
                                    d="m12,1l2.09,0.09c0.53,0.06 1.02,0.37 1.32,0.82l0.55,0.88c0.3,0.45 0.79,0.76 1.32,0.82l1.98,0.22c0.53,0.06 1.02,0.37 1.32,0.82c0.3,0.45 0.37,1.02 0.19,1.54l-0.33,1.95c-0.12,0.52 -0.02,1.07 0.28,1.49l1.39,1.96c0.37,0.42 0.44,1.02 0.19,1.54c-0.25,0.52 -0.79,0.88 -1.38,0.93l-2.09,0.22c-0.53,0.06 -1.02,0.37 -1.32,0.82l-0.55,0.88c-0.3,0.45 -0.79,0.76 -1.32,0.82L12,23l-2.09,-0.09c-0.53,-0.06 -1.02,-0.37 -1.32,-0.82l-0.55,-0.88c-0.3,-0.45 -0.79,-0.76 -1.32,-0.82l-1.98,-0.22c-0.53,-0.06 -1.02,-0.37 -1.32,-0.82c-0.3,-0.45 -0.37,-1.02 -0.19,-1.54l0.33,-1.95c0.12,-0.52 0.02,-1.07 -0.28,-1.49L1.89,13.61c-0.37,-0.42 -0.44,-1.02 -0.19,-1.54c0.25,-0.52 0.79,-0.88 1.38,-0.93l2.09,-0.22c0.53,-0.06 1.02,-0.37 1.32,-0.82l0.55,-0.88c0.3,-0.45 0.79,-0.76 1.32,-0.82L12,1z"
                                ></path>
                            </svg>
                            Admin
                        </button>
                        <button
                            class="secondary-button"
                            onclick="budgetApp.exportToPDF()"
                            title="Export PDF"
                        >
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <path
                                    d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
                                ></path>
                            </svg>
                            Export
                        </button>
                        <button
                            id="themeToggle"
                            class="theme-toggle"
                            onclick="budgetApp.toggleTheme()"
                            title="Toggle Theme"
                        >
                            <svg
                                class="theme-icon sun-icon"
                                viewBox="0 0 24 24"
                            >
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line
                                    x1="4.22"
                                    y1="4.22"
                                    x2="5.64"
                                    y2="5.64"
                                ></line>
                                <line
                                    x1="18.36"
                                    y1="18.36"
                                    x2="19.78"
                                    y2="19.78"
                                ></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line
                                    x1="4.22"
                                    y1="19.78"
                                    x2="5.64"
                                    y2="18.36"
                                ></line>
                                <line
                                    x1="18.36"
                                    y1="5.64"
                                    x2="19.78"
                                    y2="4.22"
                                ></line>
                            </svg>
                            <svg
                                class="theme-icon moon-icon"
                                viewBox="0 0 24 24"
                            >
                                <path
                                    d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                                ></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Summary Cards -->
                <section class="summary-section">
                    <div class="summary-cards">
                        <div class="summary-card income-card">
                            <div class="card-header">
                                <span class="card-title">Total Income</span>
                                <span class="card-icon">üí∞</span>
                            </div>
                            <div class="amount" id="totalIncome">‚Çπ0.00</div>
                        </div>
                        <div class="summary-card expenses-card">
                            <div class="card-header">
                                <span class="card-title">Total Expenses</span>
                                <span class="card-icon">üí∏</span>
                            </div>
                            <div class="amount" id="totalExpenses">‚Çπ0.00</div>
                        </div>
                        <div class="summary-card balance-card">
                            <div class="card-header">
                                <span class="card-title"
                                    >Available Balance</span
                                >
                                <span class="card-icon">üí≥</span>
                            </div>
                            <div class="amount" id="availableBalance">
                                ‚Çπ0.00
                            </div>
                        </div>
                        <div class="summary-card savings-card">
                            <div class="card-header">
                                <span class="card-title">Savings Rate</span>
                                <span class="card-icon">üìà</span>
                            </div>
                            <div class="amount" id="savingsRate">0%</div>
                        </div>
                    </div>
                </section>

                <!-- Charts Section -->
                <section class="charts-section">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h3 class="chart-title">Expense Distribution</h3>
                            <canvas id="expenseChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">
                                6-Month Efficiency Trend
                            </h3>
                            <canvas id="trendChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">Balance Comparison</h3>
                            <canvas id="balanceChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Budget Tables -->
                <section class="budget-section">
                    <!-- Income Section -->
                    <div class="budget-category">
                        <div class="section-header">
                            <h2 class="section-title">Income</h2>
                            <div class="table-actions">
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.addRow('income')"
                                    title="Add Income Source"
                                >
                                    <svg class="add-icon" viewBox="0 0 24 24">
                                        <line
                                            x1="12"
                                            y1="5"
                                            x2="12"
                                            y2="19"
                                        ></line>
                                        <line
                                            x1="5"
                                            y1="12"
                                            x2="19"
                                            y2="12"
                                        ></line>
                                    </svg>
                                </button>
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.showDeletePanel('income')"
                                    title="Delete Income Items"
                                >
                                    <svg
                                        class="delete-icon"
                                        viewBox="0 0 24 24"
                                    >
                                        <polyline
                                            points="3,6 5,6 21,6"
                                        ></polyline>
                                        <path
                                            d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="budget-table" id="incomeTable">
                                <thead>
                                    <tr>
                                        <th>Source</th>
                                        <th>Expected Amount</th>
                                        <th>Actual Amount</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Fixed Expenses Section -->
                    <div class="budget-category">
                        <div class="section-header">
                            <h2 class="section-title">Fixed Expenses</h2>
                            <div class="table-actions">
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.addRow('fixedExpenses')"
                                    title="Add Fixed Expense"
                                >
                                    <svg class="add-icon" viewBox="0 0 24 24">
                                        <line
                                            x1="12"
                                            y1="5"
                                            x2="12"
                                            y2="19"
                                        ></line>
                                        <line
                                            x1="5"
                                            y1="12"
                                            x2="19"
                                            y2="12"
                                        ></line>
                                    </svg>
                                </button>
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.showDeletePanel('fixedExpenses')"
                                    title="Delete Fixed Expense Items"
                                >
                                    <svg
                                        class="delete-icon"
                                        viewBox="0 0 24 24"
                                    >
                                        <polyline
                                            points="3,6 5,6 21,6"
                                        ></polyline>
                                        <path
                                            d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="budget-table" id="fixedExpensesTable">
                                <thead>
                                    <tr>
                                        <th>Expense</th>
                                        <th>Planned Amount</th>
                                        <th>Actual Amount</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Other Expenses Section -->
                    <div class="budget-category">
                        <div class="section-header">
                            <h2 class="section-title">Other Expenses</h2>
                            <div class="table-actions">
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.addRow('otherExpenses')"
                                    title="Add Other Expense"
                                >
                                    <svg class="add-icon" viewBox="0 0 24 24">
                                        <line
                                            x1="12"
                                            y1="5"
                                            x2="12"
                                            y2="19"
                                        ></line>
                                        <line
                                            x1="5"
                                            y1="12"
                                            x2="19"
                                            y2="12"
                                        ></line>
                                    </svg>
                                </button>
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.showDeletePanel('otherExpenses')"
                                    title="Delete Other Expense Items"
                                >
                                    <svg
                                        class="delete-icon"
                                        viewBox="0 0 24 24"
                                    >
                                        <polyline
                                            points="3,6 5,6 21,6"
                                        ></polyline>
                                        <path
                                            d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="budget-table" id="otherExpensesTable">
                                <thead>
                                    <tr>
                                        <th>Expense</th>
                                        <th>Amount</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Debt Section -->
                    <div class="budget-category">
                        <div class="section-header">
                            <h2 class="section-title">Debt</h2>
                            <div class="table-actions">
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.addRow('debt')"
                                    title="Add Debt"
                                >
                                    <svg class="add-icon" viewBox="0 0 24 24">
                                        <line
                                            x1="12"
                                            y1="5"
                                            x2="12"
                                            y2="19"
                                        ></line>
                                        <line
                                            x1="5"
                                            y1="12"
                                            x2="19"
                                            y2="12"
                                        ></line>
                                    </svg>
                                </button>
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.showDeletePanel('debt')"
                                    title="Delete Debt Items"
                                >
                                    <svg
                                        class="delete-icon"
                                        viewBox="0 0 24 24"
                                    >
                                        <polyline
                                            points="3,6 5,6 21,6"
                                        ></polyline>
                                        <path
                                            d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="budget-table" id="debtTable">
                                <thead>
                                    <tr>
                                        <th>Debt</th>
                                        <th>Amount</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Travel & Entertainment Section -->
                    <div class="budget-category">
                        <div class="section-header">
                            <h2 class="section-title">
                                Travel & Entertainment
                            </h2>
                            <div class="table-actions">
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.addRow('travelEntertainment')"
                                    title="Add Travel & Entertainment"
                                >
                                    <svg class="add-icon" viewBox="0 0 24 24">
                                        <line
                                            x1="12"
                                            y1="5"
                                            x2="12"
                                            y2="19"
                                        ></line>
                                        <line
                                            x1="5"
                                            y1="12"
                                            x2="19"
                                            y2="12"
                                        ></line>
                                    </svg>
                                </button>
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.showDeletePanel('travelEntertainment')"
                                    title="Delete Travel & Entertainment Items"
                                >
                                    <svg
                                        class="delete-icon"
                                        viewBox="0 0 24 24"
                                    >
                                        <polyline
                                            points="3,6 5,6 21,6"
                                        ></polyline>
                                        <path
                                            d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table
                                class="budget-table"
                                id="travelEntertainmentTable"
                            >
                                <thead>
                                    <tr>
                                        <th>Category</th>
                                        <th>Planned Amount</th>
                                        <th>Actual Amount</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Investment Section -->
                    <div class="budget-category">
                        <div class="section-header">
                            <h2 class="section-title">Investment</h2>
                            <div class="table-actions">
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.addRow('investment')"
                                    title="Add Investment"
                                >
                                    <svg class="add-icon" viewBox="0 0 24 24">
                                        <line
                                            x1="12"
                                            y1="5"
                                            x2="12"
                                            y2="19"
                                        ></line>
                                        <line
                                            x1="5"
                                            y1="12"
                                            x2="19"
                                            y2="12"
                                        ></line>
                                    </svg>
                                </button>
                                <button
                                    class="icon-button"
                                    onclick="budgetApp.showDeletePanel('investment')"
                                    title="Delete Investment Items"
                                >
                                    <svg
                                        class="delete-icon"
                                        viewBox="0 0 24 24"
                                    >
                                        <polyline
                                            points="3,6 5,6 21,6"
                                        ></polyline>
                                        <path
                                            d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="budget-table" id="investmentTable">
                                <thead>
                                    <tr>
                                        <th>Investment</th>
                                        <th>Amount</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </main>
        </div>

        <!-- Admin Panel Modal -->
        <div id="adminModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Admin Panel</h2>
                    <span class="close" onclick="budgetApp.closeAdminPanel()"
                        >&times;</span
                    >
                </div>
                <div class="modal-body">
                    <div class="admin-section">
                        <h3>Fixed Expense Templates</h3>
                        <div class="template-form">
                            <input
                                type="text"
                                id="fixedExpenseTemplateName"
                                placeholder="Template name"
                            />
                            <input
                                type="number"
                                id="fixedExpenseTemplateAmount"
                                placeholder="Amount"
                                step="0.01"
                            />
                            <button
                                onclick="budgetApp.addTemplate('fixedExpenses')"
                            >
                                Add Template
                            </button>
                        </div>
                        <div
                            id="fixedExpenseTemplates"
                            class="template-list"
                        ></div>
                    </div>
                    <div class="admin-section">
                        <h3>Debt Templates</h3>
                        <div class="template-form">
                            <input
                                type="text"
                                id="debtTemplateName"
                                placeholder="Template name"
                            />
                            <input
                                type="number"
                                id="debtTemplateAmount"
                                placeholder="Amount"
                                step="0.01"
                            />
                            <button onclick="budgetApp.addTemplate('debt')">
                                Add Template
                            </button>
                        </div>
                        <div id="debtTemplates" class="template-list"></div>
                    </div>
                    <div class="admin-section">
                        <h3>Google Sheets Configuration</h3>
                        <div class="sheets-config">
                            <p>
                                <strong>Spreadsheet ID:</strong>
                                <span id="currentSpreadsheetId"
                                    >Loading...</span
                                >
                            </p>
                            <button onclick="budgetApp.createNewSpreadsheet()">
                                Create New Spreadsheet
                            </button>
                            <button onclick="budgetApp.syncWithSheets()">
                                Manual Sync
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Panel Modal -->
        <div id="deleteModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Delete Items</h2>
                    <span class="close" onclick="budgetApp.closeDeletePanel()"
                        >&times;</span
                    >
                </div>
                <div class="modal-body">
                    <div id="deleteList" class="delete-list"></div>
                    <div class="modal-actions">
                        <button
                            class="danger-button"
                            onclick="budgetApp.confirmDelete()"
                        >
                            Delete Selected
                        </button>
                        <button
                            class="secondary-button"
                            onclick="budgetApp.closeDeletePanel()"
                        >
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script src="script.js"></script>
    </body>
</html>
